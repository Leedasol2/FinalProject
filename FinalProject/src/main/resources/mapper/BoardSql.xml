<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTDMapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.BoardMapperInter">

	<!-- 게시글 insert -->
	<insert id="insertOfBoard" parameterType="bdto">
		insert into board(mnum, subject, content, photo, writeday) values(#{mnum},#{subject},#{content},#{photo},now())
	</insert>
	
	<!-- 가장 최신 게시글 bnum -->
	<select id="getMaxBnum" resultType="int">
		select ifnull(max(bnum),0) from board
	</select>
	
	<!-- 게시글 개수 -->
	<select id="getBoardCnt" resultType="int">
		select count(*) from board
	</select>
	
	<!-- 모든 게시글 불러오기 -->
	<select id="getAllBoards" resultType="bdto">
		select * from board order by bnum desc
	</select>
	
	<!-- 페이징 불러오기 -->
	<select id="getList" parameterType="HashMap" resultType="bdto"> 
		select * from board order by bnum desc limit #{start},#{perpage} 
	</select> 
	
	<!-- bnum값으로 게시물 불러오기 -->
	<select id="getBoard" parameterType="String" resultType="bdto">
		select * from board where bnum=#{bnum}
	</select>
	
	<!-- 조회수 증가 -->
	<update id="viewUp" parameterType="String">
		update board set views=views+1 where bnum=#{bnum}
	</update>
	
	<!-- 추천 기능 -->
	<update id="likeUp" parameterType="HashMap">
		update board set likes=like+1, likesuser=#{likesuser} where bnum=#{bnum}
	</update>
	<update id="likeDown" parameterType="HashMap">
		update board set likes=like-1, likesuser=#{likesuser} where bnum=#{bnum}
	</update>
	
	<select id="getLikesUser" parameterType="String" resultType="String">
		select likesuser from board where bnum=#{bnum}
	</select>
	
	<!-- best 게시판 -->
	<select id="getBestList" parameterType="HashMap" resultType="bdto"> 
		select * from board  order by likes desc limit #{start},#{perpage} 
	</select> 
	
	<!-- 게시글 수정 -->
	<update id="updateBoard" parameterType="bdto">
		update board set subject=#{subject}, content=#{content} 
		<if test="photo!='no'">
			,photo=#{photo} 
		</if>
		where bnum=#{bnum}
	</update>
	
	
	
	
	
	
	
	
</mapper>